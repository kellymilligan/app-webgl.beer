!function(){function a(){w=new dat.GUI,w.add(S,"DragSpeed").min(.001).max(.1).step(.001),w.add(S,"DragFriction").min(.01).max(1).step(.01),w.add(S,"OriginRotation").min(-90).max(90).step(1),w.add(S,"LightIntensity").min(0).max(1).step(.01).listen(),w.add(S,"DarkScene").onChange(b),w.add(S,"RiftMode").onChange(c),dat.GUI.toggleHide(),w.domElement.style.display="none"}function b(){S.DarkScene?($("body").removeClass("is-light"),S.LightIntensity=.5):($("body").addClass("is-light"),S.LightIntensity=1)}function c(){S.RiftMode?j():k()}function d(){D=new THREE.Object3D,s.add(D);var a=function(a){if(a.lengthComputable){var b=a.loaded/a.total*100;document.getElementById("loader").innerHTML="<p>"+Math.round(b,2)+"</p>"}},b=function(a){console.log("onError...")};THREE.Loader.Handlers.add(/\.dds$/i,new THREE.DDSLoader);var c=new THREE.OBJMTLLoader;c.load("m/can.obj","m/can.mtl",e,a,b)}function e(a){E=a,E.rotation.y=Math.radians(-220);for(var b=0;b<E.children.length;b++){var c=E.children[b];R.push(c);var d=.2,e=0,f=1.35;c.applyMatrix((new THREE.Matrix4).makeTranslation(d,e,f)),c.material.map&&(c.material.map.anisotropy=C)}E.position.set(0,-30,0),D.add(E),document.getElementById("loader").style.display="none"}function f(){s=new THREE.Scene,d(),a(),t=new THREE.WebGLRenderer({alpha:!0,antialias:!0}),t.setPixelRatio(window.devicePixelRatio),t.setSize(window.innerWidth,window.innerHeight),t.setClearColor(0,1),C=t.getMaxAnisotropy(),u=document.getElementById("container"),u.appendChild(t.domElement),B=new THREE.OculusRiftEffect(t),x=new THREE.AxisHelper(10),y=new THREE.PerspectiveCamera(60,window.innerWidth/window.innerHeight,1,4e3),y.position.set(0,-2,80);var c=new THREE.AmbientLight;c.color.setRGB(.2,.2,.2),z=new THREE.AmbientLight(0),A=new THREE.AmbientLight(0),s.add(c,z,A);for(var e=[[16772829,.7,12,10,-3],[16772829,.2,-10,20,0],[16772829,.15,-45,-50,5]],f=0;f<e.length;f++){var g=new THREE.DirectionalLight(e[f][0],e[f][1]);g.position.set(e[f][2],e[f][3],e[f][4]).normalize(),s.add(g)}O=Math.radians(-170),S.DarkScene=!1,b(),h(),i()}function g(){D&&(D.rotation.z=Math.radians(S.OriginRotation),D.rotation.x+=.05*(.15*L-D.rotation.x)),E&&(O+=8e-4,E.rotation.y+=(O-E.rotation.y)*S.DragFriction,E.rotation.y+=.02*K),z.color.setRGB(1*S.LightIntensity,1*S.LightIntensity,1*S.LightIntensity),A.color.setRGB(1*S.LightIntensity,1*S.LightIntensity,1*S.LightIntensity),y.lookAt(s.position),S.RiftMode===!0?B.render(s,y):t.render(s,y),F===!0&&(i(),F=!1)}function h(){requestAnimationFrame(h),g(),v&&v.update()}function i(){M=window.innerWidth/2,N=window.innerHeight/2,y.aspect=window.innerWidth/window.innerHeight,y.updateProjectionMatrix(),t.setSize(window.innerWidth,window.innerHeight),B.setSize(window.innerWidth,window.innerHeight)}function j(){F=!0}function k(){F=!0}function l(a){I=a.clientX-M,J=a.clientY-N,L=J/H*2,K=I/G*2}function m(a){a.preventDefault(),document.addEventListener("mousemove",n,!1),document.addEventListener("mouseup",o,!1),document.addEventListener("mouseout",p,!1),Q=I,P=O}function n(a){O=P+(I-Q)*S.DragSpeed}function o(a){document.removeEventListener("mousemove",n,!1),document.removeEventListener("mouseup",o,!1),document.removeEventListener("mouseout",p,!1)}function p(a){document.removeEventListener("mousemove",n,!1),document.removeEventListener("mouseup",o,!1),document.removeEventListener("mouseout",p,!1)}function q(a){1==a.touches.length&&(a.preventDefault(),Q=a.touches[0].pageX-M,P=O)}function r(a){1==a.touches.length&&(a.preventDefault(),I=a.touches[0].pageX-M,O=P+(I-Q)*(1.1*S.DragSpeed))}var s,t,u,v,w,x,y,z,A,B,C,D,E,F=!1,G=window.innerWidth,H=window.innerHeight,I=0,J=0,K=0,L=0,M=G/2,N=H/2,O=0,P=0,Q=0,R=[],S={DragSpeed:.008,DragFriction:.08,OriginRotation:-15,LightIntensity:.5,DarkScene:!1,RiftMode:!1};document.addEventListener("mousedown",m,!1),document.addEventListener("touchstart",q,!1),document.addEventListener("touchmove",r,!1),document.addEventListener("mousemove",l,!1),$("html").on("click touchstart",".lightswitch",function(){$(this).hasClass("toggle")?($(this).removeClass("toggle"),S.DarkScene=!1,b()):($(this).addClass("toggle"),S.DarkScene=!0,b())}),$("html").on("click touchstart",".info__button",function(){var a=$(".info");a.hasClass("is-visible")?a.removeClass("is-visible"):a.addClass("is-visible")}),$("html").on("click touchstart",".info__close",function(){$(".info").removeClass("is-visible")}),$("html").on("touchend",".info p a",function(){window.open($(this).attr("href"))}),$(window).on("resize",function(){F=!0}),$(window).on("orientationchange",function(){t.setSize(320,480)}),$(window).on("load",function(){f()}),Math.radians=function(a){return a*Math.PI/180},Math.degrees=function(a){return 180*a/Math.PI}}();